<!DOCTYPE html>
<html lang="zh-cn">
<head>
<base id="base" href="${base}">
<meta charset="UTF-8">
<title>登录</title>
<link rel="stylesheet" type="text/css"
	href="/webapp/css/login/normalize.css" />
<link rel="stylesheet" type="text/css" href="/webapp/css/login/demo.css" />
<!--必要样式-->
<link rel="stylesheet" type="text/css"
	href="/webapp/css/login/component.css" />
<link rel="stylesheet" type="text/css"
	href="/webapp/lib/layui/css/layui.css" />
</head>
<body>
	<div class="container demo-1">
		<div class="content">
			<div id="large-header" class="large-header">
				<canvas id="demo-canvas"></canvas>
				<div class="logo_box">
					<h3>自在家 欢迎你！</h3>
					<form action="#" name="f" method="post">
						<div class="input_outer">
							<span class="u_user"></span> <input name="username" class="text"
								style="color: #FFFFFF !important" type="text"
								placeholder="请输入账户">
						</div>
						<div class="input_outer">
							<span class="us_uer"></span> <input name="password" class="text"
								style="color: #FFFFFF !important; position: absolute; z-index: 100;"
								value="" type="password" placeholder="请输入密码">
						</div>
						<div class="mb2">
							<a id="sub" lay-filter="sub" class="act-but submit"
								href="javascript:;" style="color: #FFFFFF">登录</a>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript" src="/webapp/lib/jquery.js"></script>
	<script type="text/javascript" src="/webapp/lib/layui/layui.js"></script>
	<script type="text/javascript" src="/webapp/lib/encrypt/jsencrypt.js"></script>
	<script src="/webapp/js/login/TweenLite.min.js"></script>
	<script src="/webapp/js/login/EasePack.min.js"></script>
	<script src="/webapp/js/login/rAF.js"></script>
	<script src="/webapp/js/login/demo-1.js"></script>
</body>
<script>
layui.use("layer",function(){
	var layer = layui.layer;  //layer初始化
	$("#sub").click(function(){
		login();
	})
	
	$("#body").keydown(function(){
		if (event.keyCode == "13") {
			login();
		}
	})
	
	//登录函数
	function login() {
		var username = $(" input[ name='username' ] ").val();
		if (!username) {
			layer.msg("请输入登录名");
			return;
		}
		var password = $(" input[ name='password' ] ").val();
		if (!password) {
			layer.msg("请输入密码");
			return;
		}
		//password = encrypt(password);
		$(" input[ name='password' ] ").val(password);
		$.ajax({
			url : '/login/check',
			data : {
				"username" : username,
				"password" : password
			},
			type : "post",
			dataType : "json",
			success : function(data) {
				if (data.code == '1') {
					 localStorage.setItem("token",data.data.token);
					 localStorage.setItem("user",data.data.user);
					 window.location.href = "/webapp/pages/index.html";
				} else {
					layer.msg(data.msg);
				}
			}
		})
	}
	
	//RSA公钥加密
	function encrypt(password) {
		var public_key = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAo3B+tB0SAStPKkMR1iKHWpuBog/uKjyza4MxOKNICpZ3rhNk73ciF3xUr8/48WRCgk6wu5Co8uC99AGavI6JQPJLRnT8wBZXQVufSKzvw0iinQE5c9/McjdQFROWcaDxfhWuaKzX3gFKLmd/ZuqWDa3EGV4ZdiV3x3mui+ILXBxwWB1f08fo83lEuU97Wr9MtQh0ixdGIgErV4VxToOeqTObM2xpruYqRN7ZQc4fNA7k20Nx2DWlHS0uQgnSXYTwPrGQ4nMw8MGi2djpgLOTKEnrJ3ThsNpoCuy4b6kA/TML8yDmGazUnYr7Xxd7T4DV90klpd4/hWU1/X6u7sQURQIDAQAB";
		var encrypt = new JSEncrypt();
		encrypt.setPublicKey(public_key);
		var encrypted = encrypt.encrypt(password);
		return encrypted;
	}
	
})

</script>
</html>